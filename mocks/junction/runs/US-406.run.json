{
  "jira_key": "US-406",
  "generated_at": "2025-12-17T22:21:21+01:00",
  "provenance": {
    "prompt_id": "g1/prompt",
    "prompt_hash": "sha256:6df317e4d541abafa76e39a9f541f243beb7ec44be717bd11f53f730064c57d2",
    "schema_id": "g2/schema",
    "schema_hash": "sha256:27fd70c748132e2788648d883fd2346f0732931812317810a7aa40ffb2eea2c9",
    "provider": "mock",
    "model": ""
  },
  "markdown": "# Test Plan for JIRA Issue US-406\n\n## Overview\nThis test plan outlines the strategy to validate the functionality of amending an existing contract and triggering repricing as per the user story US-406. The goal is to ensure that changes to mileage or duration on an active contract lead to correct pricing recalculations while tracking amendment history and notifying customers.\n\n## Test Scope\nThe following areas will be tested:\n- Amendments to mileage and duration on active contracts\n- Triggering of repricing based on amendments\n- Tracking of amendment history\n- Customer notification for new pricing\n\n## Test Strategy\n1. **Functional Testing**: Validate that all functional requirements are met.\n2. **Regression Testing**: Ensure that existing functionalities are not broken due to new changes.\n3. **Performance Testing**: Verify that the changes do not degrade performance.\n4. **Security Testing**: Ensure that the amendment process is secure and protects sensitive data.\n\n## Resources\n- Testers: [QA Engineer Names]\n- Tools: [Testing tools, e.g., Xray, JIRA]\n- Environments: [Test Environment, Staging]\n\n## Test Execution Timeline\n- Start Date: [Start Date]\n- End Date: [End Date]\n\n## Risk Assessment\n- **High**: Any issues affecting contract pricing due to incorrect calculations.\n- **Medium**: Delay in customer notifications.\n- **Low**: Minor UI discrepancies in the amendment interface.\n\n## Existing Test Cases\n- **TEST-US-406-1**: Amend contract mileage and reprice\n\n## New Test Cases\nBased on the acceptance criteria and the existing tests, the following new test cases will be proposed:\n\n- **Mileage amendment triggers repricing correctly**\n- **Amendment history is logged correctly**\n- **Customer is notified of new pricing**",
  "suggestions": [
    {
      "title": "Mileage amendment triggers repricing correctly",
      "priority": "HIGH",
      "type": "functional",
      "given": "An active contract with initial mileage set",
      "when": "The mileage is amended to a new value",
      "then": "The new pricing is calculated correctly and confirmed",
      "mapped_existing_test_key": "TEST-US-406-1"
    },
    {
      "title": "Amendment history is logged correctly",
      "priority": "MEDIUM",
      "type": "functional",
      "given": "An active contract with previous amendments",
      "when": "The mileage is amended",
      "then": "The amendment history records the old and new mileage values",
      "mapped_existing_test_key": null
    },
    {
      "title": "Customer is notified of new pricing",
      "priority": "MEDIUM",
      "type": "functional",
      "given": "An active contract with an amended mileage",
      "when": "The amendment is saved",
      "then": "The customer receives a notification of the new pricing",
      "mapped_existing_test_key": null
    }
  ],
  "raw_context": {
    "issue": {
      "key": "US-406",
      "summary": "Amend an existing contract and trigger repricing",
      "description": "As a back office user, I want to amend mileage or duration on an active contract, so that pricing is recalculated correctly.",
      "acceptance_criteria": "AC1: Mileage change triggers a repricing.\nAC2: Amendment history is tracked.\nAC3: Customer must be notified of the new pricing."
    },
    "tests": [
      {
        "key": "TEST-US-406-1",
        "summary": "Amend contract mileage and reprice",
        "steps": "Given an active contract\nWhen mileage is changed\nThen pricing is updated",
        "tags": [
          "functional"
        ]
      }
    ],
    "changes": [
      {
        "file_path": "backend/services/amendment_service.py",
        "summary": "Handle contract amendments and repricing",
        "diff_excerpt": "Recalculate monthly rent"
      },
      {
        "file_path": "backend/audit/audit_logger.py",
        "summary": "Track amendment history",
        "diff_excerpt": "Added amendment events"
      }
    ]
  }
}